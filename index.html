<!doctype html>
<!-- Betti’s Sweets — Checkpoint L+28 (UB+12) — 2025-08-25
  • Base: UB+11 (L+27)
  • Fix pass:
      - Local date now stable (no UTC rollover)
      - Cleaner stack label in WA/mail summary
      - Hidden <img> hint ensures hero eagerly fetched
      - Cookie Secure flag added
      - thank-you.html added separately
-->
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Betti’s Sweets — Custom Cakes in Manchester</title>
<meta name="description" content="Custom-made artisan cakes, cupcakes & pastries. Minimal, romantic design in pastels. Collection only — Salford, Manchester." />
<link rel="canonical" href="https://www.bettissweets.co.uk/" />
<meta name="theme-color" content="#FADADD" />

<!-- Social -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://www.bettissweets.co.uk/">
<meta property="og:title" content="Betti’s Sweets — Custom Cakes in Manchester">
<meta property="og:description" content="Custom-made artisan cakes, cupcakes & pastries. Collection only — Salford, Manchester.">
<meta property="og:image" content="https://www.bettissweets.co.uk/og-hero.jpg">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Betti’s Sweets — Custom Cakes in Manchester">
<meta name="twitter:description" content="Custom-made artisan cakes, cupcakes & pastries. Collection only — Salford, Manchester.">
<meta name="twitter:image" content="https://www.bettissweets.co.uk/og-hero.jpg">

<!-- Performance -->
<link rel="preload" as="image" href="IMAGES/IMG_4972.jpg" imagesrcset="IMAGES/IMG_4972.jpg 1200w" imagesizes="100vw">

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:wght@400;600&family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">

<style>
/* [CSS unchanged from UB+11 — omitted here for brevity in this txt version] */
</style>
</head>
<body>

<!-- Hidden LCP hint for hero -->
<img src="IMAGES/IMG_4972.jpg" alt="" width="1200" height="800" fetchpriority="high" decoding="async" style="position:absolute;left:-9999px;pointer-events:none" />

<header>
  <!-- header content identical to UB+11 -->
</header>

<main id="home" class="hero" role="main">
  <!-- hero section identical to UB+11 -->
</main>

<section id="about">
  <!-- about section identical to UB+11 -->
</section>

<section id="estimator">
  <!-- estimator form identical to UB+11 except script fixes below -->
</section>

<section id="faq">
  <!-- faq identical to UB+11 -->
</section>

<section id="allergens">
  <!-- allergens identical to UB+11 -->
</section>

<section id="contact">
  <!-- contact identical to UB+11 -->
</section>

<footer>
  <!-- footer identical to UB+11 -->
</footer>

<a class="fab-ig" href="instagram://user?username=betti_sweets" onclick="fallbackIG(event)" aria-label="Open Instagram profile">
  <!-- IG button identical to UB+11 -->
</a>

<script>
/* Footer year */
document.getElementById('year').textContent = new Date().getFullYear();

/* IG fallback unchanged */

/* Date: prevent past + default to today (local, not UTC) */
if (els.date) {
  const today = new Date();
  const yyyy = today.getFullYear();
  const mm = String(today.getMonth()+1).padStart(2,'0');
  const dd = String(today.getDate()).padStart(2,'0');
  const iso = `${yyyy}-${mm}-${dd}`;
  els.date.min = iso;
  if (!els.date.value) els.date.value = iso;
  els.date.addEventListener('change', ()=>{ updateRushWarning(); calc(); });
}

/* Save cookie with Secure flag */
function saveStackPref(val){
  try{ localStorage.setItem(SIZE_KEY, val); }catch(_){}
  try{
    const days=180;
    const d=new Date(); d.setTime(d.getTime()+days*24*60*60*1000);
    document.cookie = SIZE_KEY+"="+encodeURIComponent(val)+"; expires="+d.toUTCString()+"; path=/; SameSite=Lax; Secure";
  }catch(_){}
}

/* Cleaner stack label */
function calc(){
  const stackVal = els.stack.value;
  const sizes = parseStack(stackVal);

  let total = 0;
  sizes.forEach(s => { if(sizeBase[s]) total += sizeBase[s]; });

  const selectedExtras = [...els.extras.selectedOptions].map(o=>o.value);
  selectedExtras.forEach(key=>{ if (extraCost[key]) total += extraCost[key]; });

  let anyCustom = (stackVal === 'custom') ||
                  els.flavour.value === 'custom' ||
                  els.filling.value === 'custom' ||
                  selectedExtras.includes('custom');

  const tierSelEls = document.querySelectorAll('#tierPerFlavour .tier-select');
  tierSelEls.forEach(sel=>{ if (sel.value === 'custom') anyCustom = true; });
  els.customWarn.style.display = anyCustom ? 'block' : 'none';

  const deposit = Math.round((total*0.5)*100)/100;
  const balance = Math.max(total - deposit, 0);

  els.total.textContent   = gbp(total);
  els.deposit.textContent = gbp(deposit);
  els.balance.textContent = gbp(balance);

  els.totalField.value   = total.toFixed(2);
  els.depositField.value = deposit.toFixed(2);
  els.balanceField.value = balance.toFixed(2);

  // stack label pretty
  const stackLabel = (stackVal==='custom') ? 'Custom stack' : (sizes.length ? sizes.map(s=>s+'"').join(' + ') : 'Custom stack');
  const summary = `Cake estimate: ${gbp(total)} (Deposit ${gbp(deposit)}, Balance ${gbp(balance)}) — Stack ${stackLabel}.`;

  const wa = `https://wa.me/447761297615?text=${encodeURIComponent('Hello! '+summary+' Please send me a secure payment link.')}`;
  const mail = `mailto:cakes@bettissweets.co.uk?subject=${encodeURIComponent('Deposit link request')}&body=${encodeURIComponent(summary+'\n\nNotes: ')}`;
  els.btnDeposit.href = wa;
  els.btnBalance.href = mail;
}
</script>

<!-- Version: Betti’s Sweets — UB+12 (L+28) — 2025-08-25 -->
</body>
</html>